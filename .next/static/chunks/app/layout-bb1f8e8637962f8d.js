(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{283:(e,r,t)=>{"use strict";t.d(r,{A:()=>l,AuthProvider:()=>i});var s=t(5155),o=t(2115),a=t(5695);let n=(0,o.createContext)(void 0);function l(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function i(e){let{children:r,walletManager:l}=e,[i,c]=(0,o.useState)(null),[u,d]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!0),[m,w]=(0,o.useState)({isConnected:!1,address:null,provider:null,signer:null}),f=(0,a.useRouter)();(0,o.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("user");if(e){let r=JSON.parse(e);c(r),d(!0)}}catch(e){console.error("Session check error:",e)}finally{g(!1)}})()},[]);let y=async function(e,r){arguments.length>2&&void 0!==arguments[2]&&arguments[2],g(!0);try{let t=localStorage.getItem("registeredUsers"),s=t?JSON.parse(t):{};if(!s[e])throw Error("User not found. Please sign up first.");if(s[e].password!==r)throw Error("Invalid password. Please try again.");let o={address:s[e].address||"0x0000000000000000000000000000000000000000",username:s[e].username,email:e,totalEarnings:s[e].totalEarnings||0,totalPurchases:s[e].totalPurchases||0,totalSales:s[e].totalSales||0,joinDate:s[e].joinDate};localStorage.setItem("user",JSON.stringify(o)),c(o),d(!0)}catch(e){throw console.error("Login error:",e),e}finally{g(!1)}},S=async(e,r,t)=>{g(!0);try{let s=localStorage.getItem("registeredUsers"),o=s?JSON.parse(s):{};if(o[e])throw Error("User with this email already exists. Please log in instead.");let a={username:r,password:t,address:"0x0000000000000000000000000000000000000000",totalEarnings:0,totalPurchases:0,totalSales:0,joinDate:new Date().toISOString()};o[e]=a,localStorage.setItem("registeredUsers",JSON.stringify(o));let n={address:a.address,username:r,email:e,totalEarnings:a.totalEarnings,totalPurchases:a.totalPurchases,totalSales:a.totalSales,joinDate:a.joinDate};localStorage.setItem("user",JSON.stringify(n)),c(n),d(!0)}catch(e){throw console.error("Signup error:",e),e}finally{g(!1)}},P=async e=>{try{return await new Promise(e=>setTimeout(e,1e3)),console.log("Password reset requested for ".concat(e)),Promise.resolve()}catch(e){throw console.error("Reset password error:",e),e}},v=async e=>{try{return await new Promise(e=>setTimeout(e,500)),!0}catch(e){return console.error("Verify token error:",e),!1}},p=async(e,r)=>{try{return await new Promise(e=>setTimeout(e,1e3)),console.log("Password reset confirmed with token ".concat(e)),Promise.resolve()}catch(e){throw console.error("Confirm reset error:",e),e}},N=async()=>{try{let{walletManager:e}=await Promise.all([t.e(88),t.e(464)]).then(t.bind(t,6464)),r=await e.connect();if(w(r),u&&i){let e={...i,address:r.address||""};c(e),localStorage.setItem("user",JSON.stringify(e))}return r}catch(e){throw console.error("Wallet connection error:",e),e}},E=async()=>{try{let{walletManager:e}=await Promise.all([t.e(88),t.e(464)]).then(t.bind(t,6464)),r=await e.disconnect();if(w(r),u&&i){let e={...i,address:""};c(e),localStorage.setItem("user",JSON.stringify(e))}return r}catch(e){throw console.error("Wallet disconnection error:",e),e}},I=async e=>{if(!i)throw Error("No user logged in");try{let r={...i,...e};c(r),localStorage.setItem("user",JSON.stringify(r))}catch(e){throw console.error("Profile update error:",e),e}},O={user:i,isAuthenticated:u,isLoading:h,walletState:m,isWalletConnected:m.isConnected,walletAddress:m.address,login:y,signup:S,logout:()=>{localStorage.removeItem("user"),c(null),d(!1),m.isConnected&&E(),f.push("/")},resetPassword:P,verifyResetToken:v,confirmPasswordReset:p,connectWallet:N,disconnectWallet:E,updateProfile:I};return(0,s.jsx)(n.Provider,{value:O,children:r})}},347:()=>{},4767:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,5356,23)),Promise.resolve().then(t.bind(t,3568)),Promise.resolve().then(t.t.bind(t,347,23)),Promise.resolve().then(t.bind(t,283))},5356:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}}},e=>{e.O(0,[444,6,441,964,358],()=>e(e.s=4767)),_N_E=e.O()}]);